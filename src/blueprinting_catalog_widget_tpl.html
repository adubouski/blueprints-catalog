<section class="bl-catalog">
    <div ng-show="!currentRepo">
        <div>
            <h1>{{::listTitle}}</h1>

            <p>{{::listDescription}}</p>
        </div>

        <div>
            <table>
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Source</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tr ng-show="!loading && !repos.length">
                    <td colspan="4">No Data Found</td>
                </tr>
                <tr ng-show="loading">
                    <td colspan="4">Loading...</td>
                </tr>
                <tr ng-repeat="repo in repos">
                    <td>
                        <a href ng-click="showDetails(repo);">{{::repo.name}}</a>
                    </td>
                    <td>
                        {{::repo.description}}
                    </td>
                    <td>
                        <a href="{{::repo.html_url}}" target="_tab_{{::repo.id}}">Source</a>
                    </td>
                    <td>
                        <a href ng-click="showUpload(repo);">Upload to Manager</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div ng-show="currentRepo">
        <div>
            <a href ng-click="showList();" class="to-list">Back</a>

            <h1>{{currentRepo.name}}</h1>
            <ul class="action-links">
                <li><a href="{{currentRepo.html_url}}" target="_tab_{{currentRepo.id}}">Source</a></li>
                <li><a href="{{currentRepo.html_url}}/archive/{{currentRepo.default_branch}}.zip">Download</a></li>
                <li><a href ng-click="showUpload(currentRepo);">Upload to Manager</a></li>
            </ul>
        </div>

        <section>
            <div>
                README
                <hr/>
            </div>
            <div ng-bind-html="currentRepo.readmeContent"></div>
        </section>

        <section>
            <label>Available Tags:</label>
            <ul>
                <li ng-show="!currentRepo.tagsList.length">(None)</li>
                <li ng-repeat="tag in currentRepo.tagsList">
                    <span class="label">{{tag.name}}</span>
                </li>
            </ul>
        </section>
    </div>

    <div ng-show="uploadRepo" class="upload-backdrop"></div>
    <div ng-show="uploadRepo" class="upload-popup">
        <div class="upload-content">
            <div class="upload-header">
                <a href ng-click="closeUpload();" class="close-popup">&times;</a>
            </div>

            <div class="upload-content">
                <form novalidate name="blueprintForm">
                    <label>
                        Blueprint Name<br/>
                        <input type="text" ng-model="blueprint.id" placeholder="enter blueprint name" required/>
                    </label>
                    <label>
                        Manager Endpoint URL<br/>
                        <input type="url" ng-model="managerEndpoint" placeholder="enter manager url" required/>
                    </label>
                    <label>
                        Blueprint File Name<br/>
                        <input type="text" ng-model="blueprint.path" placeholder="enter blueprint file name" required/>
                    </label>
                    <label>
                        Source<br/>
                        <select ng-model="blueprint.url">
                            <optgroup label="Branches">
                                <option ng-repeat="b in uploadRepo.branchesList"
                                        value="{{uploadRepo.html_url}}/archive/{{b.name}}.zip"
                                        ng-selected="b.name === uploadRepo.default_branch">
                                    {{b.name}}
                                </option>
                            </optgroup>
                            <optgroup label="Tags">
                                <option ng-repeat="tag in uploadRepo.tagsList"
                                        value="{{uploadRepo.html_url}}/archive/{{tag.name}}.zip">
                                    {{tag.name}}
                                </option>
                            </optgroup>
                        </select>
                    </label>

                    <div class="alert alert-error">{{error}}</div>
                </form>
            </div>
            <div class="upload-buttons">
                <button class="btn btn-default" ng-disabled="processing" ng-click="closeUpload();">Cancel</button>
                <button class="btn btn-primary" ng-disabled="processing || blueprintForm.$invalid" ng-click="uploadBlueprint();">
                    <span ng-show="processing">Uploading...</span>
                    <span ng-hide="processing">Upload</span>
                </button>
            </div>
        </div>
    </div>
</section>
